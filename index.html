<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study Routine To-Do</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* Base styles for HTML and Body */
html {
    overflow-x: hidden; /* Prevent horizontal scrollbar on HTML */
}
body {
    font-family: "Inter", sans-serif;
    background-color: #0d0d0d;
    color: #fff;
    margin: 0;
    padding: 15px;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    box-sizing: border-box;
    overflow-x: hidden; /* Prevent horizontal scrollbar on body */
}

/* Main heading styling */
h1 {
    text-align: center;
    color: #f5f5f5;
    font-size: 2.5rem;
    margin-bottom: 20px;
    font-weight: 700;
}

/* Toggle Landscape Button Styling */
#toggleLandscapeBtn {
    background: linear-gradient(135deg, #A020F0, #8A2BE2);
    color: #fff;
    border: none;
    border-radius: 12px;
    padding: 12px 25px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    margin-bottom: 30px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(160, 32, 240, 0.4);
}
#toggleLandscapeBtn:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 6px 20px rgba(160, 32, 240, 0.6);
}
#toggleLandscapeBtn:active {
    transform: translateY(1px);
}

/* Table container for overflow and landscape transform */
.table-container {
    width: 100%;
    max-width: 98vw;
    overflow-x: auto; /* Allow horizontal scrolling on small screens */
    overflow-y: hidden; /* Hide vertical overflow */
    display: flex;
    justify-content: flex-start; /* Ensure left side is always visible */
    align-items: flex-start;
    transition: transform 0.4s ease, width 0.4s ease, height 0.4s ease;
    padding-bottom: 20px; /* Padding for scrollbar */
}

/* Landscape transform applied to the table container */
.landscape.table-container {
    width: 100vh;  /* Container's width is now viewport's height */
    height: 100vw; /* Container's height is now viewport's width */
    transform-origin: top left; /* Rotate around the top-left corner */
    transform: rotate(90deg) translateY(-100%);
    position: absolute; /* Take out of normal document flow for precise positioning */
    top: 0;
    left: 100vw; /* Position to the right edge of the viewport, so rotation brings it into view */
    margin-bottom: 0; /* Remove potential conflicting margins */
    padding-bottom: 0; /* Remove potential conflicting paddings */
}

/* Table styling */
table {
    min-width: 1200px; /* Minimum width for the table content in portrait */
    border-collapse: separate;
    border-spacing: 0 8px;
    text-align: center;
    margin-bottom: 15px;
    transition: transform 0.4s ease, min-width 0.4s ease;
    background-color: #1a1a1a;
    border-radius: 15px;
    overflow: hidden;
}

/* Adjust table within landscape container */
.landscape table {
    width: 100%; /* Make table fill 100% of its rotated parent container */
    min-width: unset; /* Remove min-width in landscape to allow it to scale */
    max-width: none; /* No max width */
}

th, td {
    padding: 12px 8px;
    border-radius: 10px;
    white-space: nowrap;
    font-weight: 500;
    font-size: 0.95rem;
    height: 65px;
    color: #fff;
    transition: transform 0.25s ease, box-shadow 0.25s ease, opacity 0.3s ease;
    vertical-align: middle;
}

th {
    background: linear-gradient(135deg, #ff7eb3, #ff758c);
    color: #fff;
    position: sticky;
    top: 0;
    z-index: 10;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

/* Specific cell backgrounds using linear gradients */
.early { background: linear-gradient(135deg, #2193b0, #6dd5ed); }
.business { background: linear-gradient(135deg, #ee0979, #ff6a00); }
.ml { background: linear-gradient(135deg, #7F00FF, #E100FF); }
.other { background: linear-gradient(135deg, #ff9966, #ff5e62); }
.blank-cell { background: linear-gradient(135deg, #000080, #4682B4); }
.buffer-brainstorm { background: linear-gradient(135deg, #fceabb, #fbda61); color: #333; }
.lab { background: linear-gradient(135deg, #8A2BE2, #A020F0); }
.teach-megha { background: linear-gradient(135deg, #8E2DE2, #4A00E0); }
.startup { background: linear-gradient(135deg, #f093fb, #f5576c); } /* New gradient for Startup */
.bmb { background: linear-gradient(135deg, #6a11cb, #2575fc); } /* New gradient for BMB */
.bmb-self { background: linear-gradient(135deg, #4CAF50, #8BC34A); } /* New gradient for BMB-Self */


.two-line-header {
    height: 90px;
    white-space: normal; /* Allow text to wrap */
    vertical-align: middle;
    padding-top: 5px;
    padding-bottom: 5px;
}

/* Dimmed/Current Day Highlighting */
tbody tr {
    opacity: 0.7;
    transition: opacity 0.3s ease;
}
.dimmed {
    opacity: 0.4 !important;
}
.current-day {
    opacity: 1 !important;
    font-weight: 700;
    box-shadow: 0 0 15px rgba(255,255,255,0.8);
    border: 2px solid #ff7eb3;
    border-radius: 12px;
    animation: glow 2s infinite alternate;
}
@keyframes glow {
    0% { box-shadow: 0 0 8px rgba(255,255,255,0.4); border-color: #ff7eb3; }
    50% { box-shadow: 0 0 25px rgba(255,255,255,0.8), 0 0 35px rgba(255,126,179,0.8); border-color: #ff7eb3; }
    100% { box-shadow: 0 0 8px rgba(255,255,255,0.4); border-color: #ff7eb3; }
}

/* Hover effect for cells */
td:hover {
    transform: translateY(-2px) scale(1.03);
    box-shadow: 0 0 25px rgba(255,255,255,0.7);
    z-index: 1;
}

/* New Styles for Namaj Table and Important Notes */
.notes-container {
    width: 100%;
    max-width: 1000px;
    margin-top: 40px;
    padding: 20px;
    background-color: #1a1a1a;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    align-items: center;
}

.notes-container h2 {
    color: #f5f5f5;
    font-size: 1.8rem;
    margin-bottom: 20px;
    font-weight: 600;
    text-align: center;
}

.namaj-table, .daily-schedule-table {
    width: 80%;
    max-width: 400px;
    border-collapse: separate;
    border-spacing: 0 5px;
    text-align: center;
    margin-bottom: 30px;
    background-color: #2a2a2a;
    border-radius: 10px;
    overflow: hidden;
}

.namaj-table th, .namaj-table td,
.daily-schedule-table th, .daily-schedule-table td {
    padding: 10px 15px;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 500;
    color: #fff;
    vertical-align: middle;
}

.namaj-table th, .daily-schedule-table th {
    background: linear-gradient(135deg, #4CAF50, #2E8B57);
    color: #fff;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 5px rgba(0,0,0,0.2);
}

.namaj-table tr:nth-child(even) td,
.daily-schedule-table tr:nth-child(even) td {
    background-color: #333333;
}

.namaj-table tr:nth-child(odd) td,
.daily-schedule-table tr:nth-child(odd) td {
    background-color: #2a2a2a;
}

.important-notes-card {
    background: linear-gradient(135deg, #6A11CB, #2575FC);
    padding: 20px;
    border-radius: 15px;
    margin-top: 20px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    text-align: center;
}

.important-notes-card p {
    font-size: 1.1rem;
    line-height: 1.6;
    margin: 10px 0;
    font-weight: 500;
}

.important-notes-card strong {
    color: #ffe0b2;
}


/* Media queries for responsiveness */
@media (max-width: 768px) {
    h1 {
        font-size: 2rem;
    }
    th, td {
        padding: 10px 6px;
        font-size: 0.85rem;
        height: 55px;
    }
    table {
        min-width: 900px;
    }
    .namaj-table, .daily-schedule-table {
        width: 95%;
    }
    .important-notes-card {
        width: 95%;
    }
}

@media (max-width: 480px) {
    body {
        padding: 10px;
    }
    h1 {
        font-size: 1.8rem;
    }
    #toggleLandscapeBtn {
        padding: 10px 18px;
        font-size: 0.9rem;
    }
    th, td {
        padding: 8px 4px;
        font-size: 0.8rem;
        height: 50px;
    }
    table {
        min-width: 800px;
    }
    .notes-container h2 {
        font-size: 1.5rem;
    }
    .namaj-table th, .namaj-table td,
    .daily-schedule-table th, .daily-schedule-table td {
        font-size: 0.9rem;
        padding: 8px 10px;
    }
    .important-notes-card p {
        font-size: 1rem;
    }
}
</style>
</head>
<body>

<h1>Weekly Study Routine To-Do</h1>
<button id="toggleLandscapeBtn">ðŸŒ„ Toggle Landscape View</button>

<div id="dailyScheduleContainer" class="notes-container">
    <h2>Today's Schedule</h2>
    <table id="dailyScheduleTable" class="daily-schedule-table">
        <thead>
            <tr>
                <th>Time</th>
                <th>Activity</th>
            </tr>
        </thead>
        <tbody>
            <!-- Daily schedule will be populated here by JavaScript -->
        </tbody>
    </table>
</div>

<div class="table-container" id="tableContainer">
    <table id="routineTable">
        <thead>
            <tr>
                <th class="two-line-header">Day</th>
                <th class="two-line-header">4:00 â€“ 6:00<br>AM</th>
                <th class="two-line-header">6:00 â€“ 7:00<br>AM</th>
                <th class="two-line-header">7:00 â€“ 8:00<br>AM<br>Buffer</th>
                <th class="two-line-header">8:00 AM â€“<br>1:00 PM</th>
                <th class="two-line-header">1:00 â€“ 2:00 PM<br>Namaj</th>
                <th class="two-line-header">2:00 â€“ 3:00<br>PM</th>
                <th class="two-line-header">3:00 â€“ 4:00<br>PM</th>
                <th class="two-line-header">4:00 â€“ 5:00<br>PM</th>
                <th class="two-line-header">5:00 â€“ 6:00 PM<br>Buffer</th>
                <th class="two-line-header">6:00 â€“ 7:00<br>PM</th>
                <th class="two-line-header">7:00 â€“ 8:00<br>PM</th>
                <th class="two-line-header">8:00 â€“ 8:30<br>PM</th>
                <th class="two-line-header">8:30 â€“ 10:00<br>PM</th>
                <th class="two-line-header">10:00 â€“ 11:00<br>PM<br>Namaj</th>
            </tr>
        </thead>
        <tbody>
            <!-- Friday -->
            <tr data-day="Friday">
                <th>Friday</th>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="blank-cell">Prayer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="other">Walking Session</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="teach-megha">Teach Megha</td>
                <td class="teach-megha">Teach Megha</td>
                <td class="blank-cell">Break</td>
                <td class="ml">ML Project</td>
                <td class="buffer-brainstorm">Buffer</td>
            </tr>
            <!-- Saturday -->
            <tr data-day="Saturday">
                <th>Saturday</th>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="startup">Startup</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="teach-megha">Teach Megha (8-10 AM)<br>Self-Paced DL (10 AM-1 PM)</td>
                <td class="blank-cell">Prayer</td>
                <td class="ml">Self-Paced Deep Learning</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="other">Walking Session</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="blank-cell">Break</td>
                <td class="ml">ML Project</td>
                <td class="blank-cell">Prayer</td>
            </tr>
            <!-- Sunday -->
            <tr data-day="Sunday">
                <th>Sunday</th>
                <td class="early">Early Study</td>
                <td class="startup">Startup</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb">BMB</td>
                <td class="blank-cell">Prayer</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="blank-cell">Break</td>
                <td class="ml">ML Project</td>
                <td class="blank-cell">Prayer</td>
            </tr>
            <!-- Monday -->
            <tr data-day="Monday">
                <th>Monday</th>
                <td class="early">Early Study</td>
                <td class="startup">Startup</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb">BMB</td>
                <td class="blank-cell">Prayer</td>
                <td class="lab">Lab Work</td>
                <td class="lab">Lab Work</td>
                <td class="lab">Lab Work</td>
                <td class="buffer-brainstorm">Brainstorm</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="blank-cell">Break</td>
                <td class="ml">ML Project</td>
                <td class="blank-cell">Prayer</td>
            </tr>
            <!-- Tuesday -->
            <tr data-day="Tuesday">
                <th>Tuesday</th>
                <td class="early">Early Study</td>
                <td class="startup">Startup</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb">BMB</td>
                <td class="blank-cell">Prayer</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="blank-cell">Break</td>
                <td class="ml">ML Project</td>
                <td class="blank-cell">Prayer</td>
            </tr>
            <!-- Wednesday -->
            <tr data-day="Wednesday">
                <th>Wednesday</th>
                <td class="early">Early Study</td>
                <td class="startup">Startup</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb">BMB</td>
                <td class="blank-cell">Prayer</td>
                <td class="lab">Lab Work</td>
                <td class="lab">Lab Work</td>
                <td class="lab">Lab Work</td>
                <td class="buffer-brainstorm">Brainstorm</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="blank-cell">Break</td>
                <td class="ml">ML Project</td>
                <td class="blank-cell">Prayer</td>
            </tr>
            <!-- Thursday -->
            <tr data-day="Thursday">
                <th>Thursday</th>
                <td class="early">Early Study</td>
                <td class="startup">Startup</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb">BMB</td>
                <td class="blank-cell">Prayer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="bmb-self">BMB-Self</td>
                <td class="buffer-brainstorm">Buffer</td>
                <td class="blank-cell">Break</td>
                <td class="ml">ML Project</td>
                <td class="blank-cell">Prayer</td>
            </tr>
        </tbody>
    </table>
</div>

<div class="notes-container">
    <h2>Daily Namaj Times</h2>
    <table class="namaj-table">
        <thead>
            <tr>
                <th>Prayer</th>
                <th>Time (Approx.)</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>Fajar</td><td>5:00 AM</td></tr>
            <tr><td>Zohar</td><td>1:00 PM</td></tr>
            <tr><td>Asar</td><td>4:30 PM</td></tr>
            <tr><td>Magrib</td><td>6:45 PM</td></tr>
            <tr><td>Esha</td><td>8:30 PM</td></tr>
        </tbody>
    </table>

    <h2>Important Notes</h2>
    <div class="important-notes-card">
        <p>â˜• **Eat a cup of coffee at 1:00 PM.**</p>
        <p>Always keep your **coffee mug** with you!</p>
    </div>
</div>

<script>
const routineTable = document.getElementById("routineTable");
const tableRows = routineTable.querySelectorAll("tbody tr");
const toggleLandscapeBtn = document.getElementById("toggleLandscapeBtn");
const tableContainer = document.getElementById("tableContainer");
const dailyScheduleTableBody = document.querySelector("#dailyScheduleTable tbody");

function initializeRoutineDisplay() {
    const today = new Date();
    const dayOfWeek = today.getDay(); // 0=Sunday, 1=Monday, ... 6=Saturday
    // Adjusting dayMap to match 0-indexed rows in HTML body after Friday
    // Friday: 0, Saturday: 1, Sunday: 2, Monday: 3, Tuesday: 4, Wednesday: 5, Thursday: 6
    const dayMap = { 5:0, 6:1, 0:2, 1:3, 2:4, 3:5, 4:6 };
    const currentDayRowIndex = dayMap[dayOfWeek];

    // Remove any existing highlighting classes first
    tableRows.forEach((row) => {
        row.classList.remove("current-day", "dimmed");
    });

    // Apply current-day or dimmed class
    tableRows.forEach((row, index) => {
        if(index === currentDayRowIndex) {
            row.classList.add("current-day");
        } else {
            row.classList.add("dimmed");
        }
    });

    // Load task completion status from localStorage
    tableRows.forEach(row => {
        const dayDataset = row.dataset.day;
        // Select all `td` elements within the row (excluding the `th` day header)
        const cells = row.querySelectorAll("td");
        cells.forEach((cell,i)=>{
            const key = `${dayDataset}-${i}`; // Unique key for each cell
            if(localStorage.getItem(key) === "done") {
                cell.style.opacity = "0.2"; // Dim if marked as done
            } else {
                cell.style.opacity = "1"; // Ensure full opacity if not done
            }
        });
    });

    displayCurrentDaySchedule(); // Call this to populate the daily schedule table
}

function toggleTaskCompletion(cell, dayDataset, cellIndex) {
    const key = `${dayDataset}-${cellIndex}`;
    // Toggle opacity and update localStorage
    if(cell.style.opacity === "0.2") {
        cell.style.opacity = "1";
        localStorage.removeItem(key); // Remove item if unmarked (full opacity)
    } else {
        cell.style.opacity = "0.2";
        localStorage.setItem(key, "done"); // Set item if marked done (dimmed)
    }
    // Re-display current day's schedule after a change
    displayCurrentDaySchedule();
}

function addCellClickListeners() {
    tableRows.forEach(row => {
        const dayDataset = row.dataset.day;
        // Select all `td` elements in the row for click listeners
        const cells = row.querySelectorAll("td");
        cells.forEach((cell,i)=>{
            // Only add click listener if the cell is not a 'blank-cell' and has content
            if(cell.textContent.trim() !== "" && !cell.classList.contains('blank-cell')) {
                cell.addEventListener("click", () => toggleTaskCompletion(cell, dayDataset, i));
            }
        });
    });
}

function displayCurrentDaySchedule() {
    dailyScheduleTableBody.innerHTML = ''; // Clear previous entries

    const today = new Date();
    const dayOfWeek = today.getDay(); // 0=Sunday, 1=Monday, ... 6=Saturday
    const dayMap = { 5:0, 6:1, 0:2, 1:3, 2:4, 3:5, 4:6 };
    const currentDayRowIndex = dayMap[dayOfWeek];

    const currentDayRow = tableRows[currentDayRowIndex];
    if (!currentDayRow) return; // Exit if no row for today

    const timeHeaders = Array.from(routineTable.querySelectorAll("thead th")).slice(1); // Skip 'Day' header
    const currentDayCells = Array.from(currentDayRow.querySelectorAll("td"));

    timeHeaders.forEach((header, index) => {
        let timeSlot = header.textContent.replace(/\s+/g, ' ').trim(); // Clean up text content
        // Extract only the time range (e.g., "4:00 â€“ 6:00 AM")
        const timeMatch = timeSlot.match(/(\d{1,2}:\d{2}\s*â€“\s*\d{1,2}:\d{2}\s*(?:AM|PM))/i);
        if (timeMatch) {
            timeSlot = timeMatch[1].trim();
        }


        const activity = currentDayCells[index] ? currentDayCells[index].textContent.trim() : '';

        // Only add rows if there's an activity or it's a prayer/break
        // Also ensure it's not just "Buffer" if that's not desired in daily view
        if (activity !== "" && activity !== "Buffer") { /* Added check for "Buffer" */
            const row = dailyScheduleTableBody.insertRow();
            const timeCell = row.insertCell();
            const activityCell = row.insertCell();

            timeCell.textContent = timeSlot;
            activityCell.textContent = activity;

            // Apply styling classes to the activity cell based on the main table's cell
            const mainTableCellClasses = Array.from(currentDayCells[index].classList);
            mainTableCellClasses.forEach(className => {
                if (className !== 'current-day' && className !== 'dimmed') { // Avoid highlighting classes from main table
                    activityCell.classList.add(className);
                }
            });
        }
    });

    // If no activities are listed for today (e.g., all are Buffer or blank), add a note
    if (dailyScheduleTableBody.rows.length === 0) {
        const row = dailyScheduleTableBody.insertRow();
        const cell = row.insertCell();
        cell.colSpan = 2; // Span across both columns
        cell.textContent = "No specific activities scheduled for today. Enjoy your buffer time!";
        cell.style.fontStyle = "italic";
        cell.style.color = "#aaa";
        cell.style.padding = "20px";
        cell.style.backgroundColor = "#2a2a2a";
        cell.style.borderRadius = "8px";
    }
}


// Event listener for the toggle landscape button
toggleLandscapeBtn.addEventListener("click", () => {
    tableContainer.classList.toggle("landscape");
    // Change button text based on the landscape class presence
    if (tableContainer.classList.contains("landscape")) {
        toggleLandscapeBtn.textContent = "ðŸ”„ Exit Landscape View";
    } else {
        toggleLandscapeBtn.textContent = "ðŸŒ„ Toggle Landscape View";
    }
});

// Initialize display and add listeners when the DOM is fully loaded
document.addEventListener("DOMContentLoaded", () => {
    initializeRoutineDisplay();
    addCellClickListeners();
});

// Re-initialize display on window load to ensure all styles are applied consistently
window.onload = initializeRoutineDisplay;
</script>

</body>
</html>
